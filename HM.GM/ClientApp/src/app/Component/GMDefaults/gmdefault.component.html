
<div class="container">
  <div class="row">
    <div class="gmtable">
      <ng2-smart-table [settings]="settings" [source]="gridData" *ngIf="complete;" (mode)="external" (create)="onCreateConfirm($event)"></ng2-smart-table>
      <div class="row">
        <div class="col-md-9">&nbsp;</div>
        <div class="col-md-1"><span class="text-center">{{TotalBilling | number : '1.2-2'}}</span></div>
        <div class="col-md-1"><span class="text-center">{{TotalOnSiteCost | number : '1.2-2'}}</span></div>
        <div class="col-md-1"><span class="text-center">{{TotalGMPercentage | number : '1.2-2'}}</span></div>
      </div>
    </div>
  </div>
  <div>&nbsp;</div>
  <div class="sub-container">
    <div class="row">
      <form #f="ngForm" (ngSubmit)="onDefaultSubmit()">
        <table class="table">
          <thead class="thead-inverse">
            <tr>
              <th class="text-center">Avergae Billing Rate</th>
              <th class="text-center">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left">Contengency</td>
              <td class="text-center">
                <input type="text" name="contengency" class="form-control" maxlength="3" required [(ngModel)]="gmdefaults.Contengency" pattern="[0-9]*" />
              </td>
            </tr>
            <tr>
              <td class="text-left">Number of hours per day</td>
              <td class="text-center">
                <input type="text" name="hoursPerDay" class="form-control" maxlength="3" required [(ngModel)]="gmdefaults.HoursPerDay" pattern="[0-9]*" />
              </td>
            </tr>
            <tr>
              <td class="text-left">Number of days in a week </td>
              <td class="text-center">
                <input type="text" name="daysPerWeek" class="form-control" maxlength="1" required [(ngModel)]="gmdefaults.DaysPerWeek" pattern="[0-9]*" />
              </td>
            </tr>
            <tr>
              <td class="text-left">Number of days per month</td>
              <td class="text-center">
                <input type="text" name="daysPerMonth" class="form-control" maxlength="2" required [(ngModel)]="gmdefaults.DaysPerMonth" pattern="[0-9]*" />
              </td>
            </tr>
            <tr>
              <td class="text-left">Number of weeks per month</td>
              <td class="text-center">
                <input type="text" name="weeksPerMonth" class="form-control" maxlength="3" required [(ngModel)]="gmdefaults.WeeksPerMonth" pattern="[0-9]*" />
              </td>
            </tr>
            <tr>
              <td class="text-left">$ Converstion to INR</td>
              <td class="text-center">
                <input type="text" name="dollarValueInINR" class="form-control" maxlength="9" required [(ngModel)]="gmdefaults.DollarValueInINR" pattern="[0-9]*" />
              </td>
            </tr>
          </tbody>
        </table>
        <!--<input type="submit" [disabled]="!f.form.valid" class="btn btn-primary" value="Submit" />-->
      </form>
    </div>
  </div>
  <div class="row">
    <button type="button" class="btn btn-success" (click)="Save()">Calculate GM</button>
    <button type="button" class="btn btn-info" (click)="tableToExcel('gridTable', 'GM Table')">Export To Excel</button>
  </div>
  <div class="row" id="gridTable" [hidden]="true">
    <table>
      <thead>
        <tr>
          <th *ngFor="let head of rowKeys(excelData[0])">{{head}}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of excelData">
          <td *ngFor="let data of rowKeys(row)">{{row[data]}}</td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
